Fixing Link Length in a Computational Stream Network

Robert Steinke

Abstract:

When simulating the hydrology of a stream network there is often a desired distance between computational nodes determined by the desired spatial resolution of the simulation.  However, stream networks are often delineated as links between junctions, and the lengths of these links may not be close to the desired distance.  If a link is too long, it can be broken into multiple computational elements, but if a link is too short, the problem is harder to fix.  This whitepaper describes the methods used by the ADHydro project to pre-process stream networks to solve these problems.

Links that are too long

Long links can be broken into multiple computational elements.  The only difficulty with this is that the link will probably not be an integer multiple of the desired distance.  The most extreme case occurs when the link is between one and two times the desired length, and the only option is to split the link into two relatively short elements.  We desire to get the actual element length as close as possible to the desired element length, but what metric should we use for "closeness"?  In the ADHydro project, we use the ratio of the longer of the desired or actual length to the shorter of the two.  For example, if a link is 1.6 times the desired length then the two options are one element with a length of 1.6 (closeness metric = 1.6/1.0 = 1.6) or two elements each with a length of 0.8 (closeness metric = 1.0/0.8 = 1.25).  In this case splitting into two elements gets closer to the desired length.  Using this metric, the worst possible closeness score is approimately 1.4 when splitting the link would result in two elements of length 0.7.

Links that are too short

When an entire link is shorter than the desired distance then a different strategy must be used.  First, we decide whether or not the shortness of a particular link is bad enough to be worth fixing.  Since the worst possible closeness score from splitting long links is approimately 1.4, we use this as the threshold below which we fix short links.  The strategy for fixing short links is as follows:  The length of the short link is added to the lengths of all of its upstream neighbors.  Then those neighbors are disconnected from the short link and connected to all links downstream of the short link.  Then the short link is pruned.  This algorithm for fixing short links is applied before splitting long links.  It is applied to one short link at a time until all short links have been fixed.  If there are two adjacent short links, fixing one may make the other not short anymore, and the fix is not applied to that link.

There may be links that cannot be pruned for various reasons.  A link might be connected to some other structure in the simulation, such as a simulated gauging station, irrigation diversion, etc.  If a link must be in the network because of external connections, but it is too short, then we arbitrarily increase its length to the minimum needed for an acceptable closeness score.  In ADHydro, we can do this increase without modifying the geometric map.  We store the vertices of stream links for display purposes only, and we store a separate length variable for elements that is used for all computational purposes.  For this reason, the length of the polyline along the vertices does not need to be consistent with the computational length value.  Arbitrarily increasing the length could be justified as sub-resolution sinuosity, but in practice this situation is rare and the modified value has negligible effect on the overall simulation.
